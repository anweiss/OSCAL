{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "oscal-profile.json",
  "definitions": {
    "profile": {
      "$id": "#/definitions/profile",
      "type": "object",
      "properties": {
        "id": {
          "$ref": "oscal-catalog.json#/definitions/id"
        },
        "title": {
          "$ref": "oscal-catalog.json#/definitions/title"
        },
        "imports": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/import"
          },
          "minItems": 1
        },
        "merge": {
          "$ref": "#/definitions/merge"
        },
        "modify": {
          "$ref": "#/definitions/modify"
        }
      },
      "propertyNames": {
        "enum": [
          "id",
          "title",
          "imports",
          "merge",
          "modify"
        ]
      }
    },
    "import": {
      "$id": "#/definitions/import",
      "type": "object",
      "properties": {
        "href": {
          "$ref": "oscal-catalog.json#/definitions/href"
        },
        "include": {
          "$ref": "#/definitions/include"
        },
        "exclude": {
          "$ref": "#/definitions/exclude"
        }
      },
      "propertyNames": {
        "enum": [
          "href",
          "include",
          "exclude"
        ]
      }
    },
    "merge": {
      "$id": "#/definitions/merge",
      "type": "object",
      "properties": {
        "combine": {
          "$ref": "#/definitions/combine"
        },
        "build": {
          "$ref": "#/definitions/build"
        },
        "frame": {
          "$ref": "#/definitions/frame"
        }
      },
      "propertyNames": {
        "enum": [
          "combine",
          "asIs",
          "custom"
        ]
      }
    },
    "combine": {
      "$id": "#/definitions/combine",
      "type": "object",
      "properties": {
        "method": {
          "type": "string",
          "enum": [
            "use-first",
            "merge",
            "keep"
          ]
        }
      },
      "propertyNames": {
        "enum": [
          "method"
        ]
      }
    },
    "build": {
      "$id": "#/definitions/build",
      "type": "boolean"
    },
    "frame": {
      "$id": "#/definitions/frame",
      "type": "object",
      "properties": {
        "id": {
          "$ref": "oscal-catalog.json#/definitions/id"
        },
        "optionalClass": {
          "$ref": "oscal-catalog.json#/definitions/optionalClass"
        },
        "title": {
          "$ref": "oscal-catalog.json#/definitions/title"
        },
        "profileGroups": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/profileGroup"
          }
        },
        "calls": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/call"
          }
        },
        "matches": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/match"
          }
        }
      },
      "propertyNames": {
        "enum": [
          "id",
          "class",
          "title",
          "groups",
          "calls",
          "matches"
        ]
      }
    },
    "profileGroup": {
      "$id": "#/definitions/profileGroup",
      "type": "object",
      "properties": {
        "title": {
          "$ref": "oscal-catalog.json#/definitions/title"
        },
        "profileGroups": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/profileGroup"
          }
        },
        "calls": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/call"
          }
        },
        "matches": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/match"
          }
        }
      },
      "propertyNames": {
        "enum": [
          "title",
          "groups",
          "calls",
          "matches"
        ]
      }
    },
    "modify": {
      "$id": "#/definitions/modify",
      "type": "object",
      "properties": {
        "paramSettings": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/paramSetting"
          }
        },
        "alterations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/alteration"
          }
        }
      },
      "propertyNames": {
        "enum": [
          "paramSettings",
          "alterations"
        ]
      }
    },
    "include": {
      "$id": "#/definitions/include",
      "type": "object",
      "anyOf": [
        {
          "$ref": "#/definitions/all"
        },
        {
          "type": "object",
          "properties": {
            "calls": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/call"
              }
            },
            "matches": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/match"
              }
            }
          },
          "propertyNames": {
            "enum": [
              "calls",
              "matches"
            ]
          }
        }
      ]
    },
    "all": {
      "$id": "#/definitions/all",
      "oneOf": [
        {
          "type": "boolean"
        },
        {
          "type": "object",
          "properties": {
            "withSubcontrols": {
              "$ref": "#/definitions/withSubcontrols"
            }
          },
          "propertyNames": {
            "enum": [
              "withSubcontrols"
            ]
          }
        }
      ]
    },
    "withSubcontrols": {
      "$id": "#/definitions/withSubcontrols",
      "type": "boolean"
    },
    "withControl": {
      "$id": "#/definitions/withControl",
      "type": "boolean"
    },
    "call": {
      "$id": "#/definitions/call",
      "type": "object",
      "oneOf": [
        {
          "properties": {
            "withSubcontrols": {
              "$ref": "#/definitions/withSubcontrols"
            },
            "controlId": {
              "$ref": "#/definitions/controlId"
            }
          },
          "propertyNames": {
            "enum": [
              "withSubcontrols",
              "controlId"
            ]
          }
        },
        {
          "properties": {
            "withControl": {
              "$ref": "#/definitions/withControl"
            },
            "subcontrolId": {
              "$ref": "#/definitions/controlId"
            }
          },
          "propertyNames": {
            "enum": [
              "withControl",
              "subcontrolId"
            ]
          }
        }
      ]
    },
    "match": {
      "$id": "#/definitions/match",
      "type": "object",
      "properties": {
        "withSubcontrols": {
          "$ref": "#/definitions/withSubcontrols"
        },
        "withControl": {
          "$ref": "#/definitions/withControl"
        },
        "pattern": {
          "$ref": "#/definitions/pattern"
        },
        "order": {
          "$ref": "#/definitions/order"
        }
      },
      "propertyNames": {
        "enum": [
          "withSubcontrols",
          "withControl",
          "pattern",
          "order"
        ]
      }
    },
    "exclude": {
      "$id": "#/definitions/exclude",
      "type": "object",
      "properties": {
        "match": {
          "$ref": "#/definitions/match"
        },
        "excludeCalls": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/excludeCall"
          }
        }
      },
      "propertyNames": {
        "enum": [
          "match",
          "calls"
        ]
      }
    },
    "excludeCall": {
      "$id": "#/definitions/excludeCall",
      "type": "object",
      "properties": {
        "controlId": {
          "$ref": "#/definitions/controlId"
        }
      },
      "propertyNames": {
        "oneOf": [
          {
            "enum": [
              "controlId"
            ]
          },
          {
            "enum": [
              "subcontrolId"
            ]
          }
        ]
      }
    },
    "paramSetting": {
      "$id": "#/definitions/paramSetting",
      "type": "object",
      "properties": {
        "paramId": {
          "$ref": "#/definitions/paramId"
        },
        "optionalClass": {
          "$ref": "oscal-catalog.json#/definitions/optionalClass"
        },
        "label": {
          "$ref": "oscal-catalog.json#/definitions/label"
        },
        "desc": {
          "$ref": "oscal-catalog.json#/definitions/desc"
        },
        "req": {
          "$ref": "oscal-catalog.json#/definitions/req"
        },
        "value": {
          "$ref": "oscal-declarations.json#/definitions/value"
        },
        "select": {
          "$ref": "oscal-catalog.json#/definitions/select"
        },
        "links": {
          "type": "array",
          "items": {
            "$ref": "oscal-catalog.json#/definitions/link"
          }
        },
        "parts": {
          "type": "array",
          "items": {
            "$ref": "oscal-catalog.json#/definitions/part"
          }
        },
        "references": {
          "$ref": "oscal-catalog.json#/definitions/references"
        }
      },
      "propertyNames": {
        "enum": [
          "paramId",
          "class",
          "label",
          "desc",
          "requirement",
          "value",
          "select",
          "links",
          "parts",
          "references"
        ]
      }
    },
    "alteration": {
      "$id": "#/definitions/alteration",
      "type": "object",
      "properties": {
        "controlId": {
          "$ref": "#/definitions/controlId"
        },
        "subcontrolId": {
          "$ref": "#/definitions/controlId"
        },
        "removals": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/remove"
          }
        },
        "augmentations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/augment"
          }
        }
      },
      "propertyNames": {
        "anyOf": [
          {
            "enum": [
              "controlId",
              "removals",
              "additions"
            ]
          },
          {
            "enum": [
              "subcontrolId",
              "removals",
              "additions"
            ]
          }
        ]
      }
    },
    "remove": {
      "$id": "#/definitions/remove",
      "type": "object",
      "properties": {
        "classRef": {
          "$ref": "#/definitions/classRef"
        },
        "idRef": {
          "$ref": "#/definitions/idRef"
        },
        "itemName": {
          "$ref": "#/definitions/itemName"
        }
      },
      "propertyNames": {
        "enum": [
          "classRef",
          "idRef",
          "itemName"
        ]
      }
    },
    "classRef": {
      "$id": "#/definitions/classRef",
      "type": "string",
      "pattern": "^\\S*[a-zA-Z0-9.\\-_\\:]\\S*$"
    },
    "idRef": {
      "$id": "#/definitions/idRef",
      "type": "string"
    },
    "itemName": {
      "$id": "#/definitions/itemName",
      "type": "string"
    },
    "augment": {
      "$id": "#/definitions/augment",
      "type": "object",
      "properties": {
        "position": {
          "$ref": "#/definitions/position"
        },
        "title": {
          "$ref": "oscal-catalog.json#/definitions/title"
        },
        "params": {
          "type": "array",
          "items": {
            "$ref": "oscal-catalog.json#/definitions/param"
          }
        },
        "props": {
          "type": "array",
          "items": {
            "$ref": "oscal-catalog.json#/definitions/prop"
          }
        },
        "parts": {
          "type": "array",
          "items": {
            "$ref": "oscal-catalog.json#/definitions/part"
          }
        }
      },
      "propertyNames": {
        "enum": [
          "position",
          "title",
          "params",
          "props",
          "parts"
        ]
      }
    },
    "position": {
      "$id": "#/definitions/position",
      "type": "string",
      "enum": [
        "before",
        "after",
        "starting",
        "ending"
      ]
    },
    "controlId": {
      "$id": "#/definitions/controlId",
      "type": "string"
    },
    "pattern": {
      "$id": "#/definitions/pattern",
      "type": "string"
    },
    "order": {
      "$id": "#/definitions/order",
      "type": "string",
      "enum": [
        "keep",
        "ascending",
        "descending"
      ]
    },
    "paramId": {
      "$id": "#/definitions/paramId",
      "type": "string",
      "pattern": "^\\S*[a-zA-Z0-9.\\-_\\:]\\S*$"
    }
  },
  "type": "object",
  "properties": {
    "profile": {
      "$ref": "#/definitions/profile"
    }
  },
  "propertyNames": {
    "enum": [
      "profile"
    ]
  }
}